<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DeSolvers · DataAssimilationBenchmarks</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">DataAssimilationBenchmarks</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">DataAssimilationBenchmarks</span><ul><li><a class="tocitem" href="../../../home/Introduction/">Introduction</a></li><li><a class="tocitem" href="../../../home/Getting Started/">Getting Started</a></li><li><a class="tocitem" href="../../../home/DataAssimilationBenchmarks/">Global Types</a></li></ul></li><li><span class="tocitem">Submodules</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../models/L96/">L96</a></li><li><a class="tocitem" href="../../models/IEEE39bus/">IEEE39bus</a></li><li><a class="tocitem" href="../../models/ObsOperators/">ObsOperators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>DeSolvers</a><ul class="internal"><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li></ul></li><li><a class="tocitem" href="../EnsembleKalmanSchemes/">EnsembleKalmanSchemes</a></li><li><a class="tocitem" href="../XdVAR/">XdVAR</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../experiments/Workflow/">Workflow</a></li><li><a class="tocitem" href="../../experiments/GenerateTimeSeries/">GenerateTimeSeries</a></li><li><a class="tocitem" href="../../experiments/FilterExps/">FilterExps</a></li><li><a class="tocitem" href="../../experiments/SmootherExps/">SmootherExps</a></li><li><a class="tocitem" href="../../experiments/SingleExperimentDriver/">SingleExperimentDriver</a></li><li><a class="tocitem" href="../../experiments/ParallelExperimentDriver/">ParallelExperimentDriver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../analysis/ProcessExperimentData/">ProcessExperimentData</a></li><li><a class="tocitem" href="../../analysis/PlotExperimentData/">PlotExperimentData</a></li></ul></li></ul></li><li><span class="tocitem">Community</span><ul><li><a class="tocitem" href="../../../community/Contributing/">Contributing</a></li><li><a class="tocitem" href="../../../community/CodeOfConduct/">Contributor Covenant Code of Conduct</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>DeSolvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DeSolvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/master/docs/src/submodules/methods/DeSolvers.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-Equation-Solvers"><a class="docs-heading-anchor" href="#Differential-Equation-Solvers">Differential Equation Solvers</a><a id="Differential-Equation-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Equation-Solvers" title="Permalink"></a></h1><p>Three general schemes are developed for ordinary and stochastic differential equations,</p><ul><li>the four-stage Runge-Kutta <a href="#DataAssimilationBenchmarks.DeSolvers.rk4_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.rk4_step!</code></a> scheme,</li><li>the second order autonomous Taylor <a href="#DataAssimilationBenchmarks.DeSolvers.tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.tay2_step!</code></a> scheme, and</li><li>the Euler-(Maruyama) <a href="#DataAssimilationBenchmarks.DeSolvers.em_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.em_step!</code></a> scheme.</li></ul><p>These schemes have arguments with the conventions:</p><ul><li><code>x</code> - model states of type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.VecA-Tuple{Any}"><code>VecA</code></a> possibly including a statistical replicate of model parameter values;</li><li><code>t</code> - time value of type <a href="https://docs.julialang.org/en/v1/base/numbers/#Core.Float64"><code>Float64</code></a> for present model state (a dummy argument is used for autonomous dynamics);</li><li><code>kwargs</code> - a dictionary of type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.StepKwargs"><code>StepKwargs</code></a>.</li></ul><p>Details of these schemes are available in the manuscript <a href="https://gmd.copernicus.org/articles/13/1903/2020/gmd-13-1903-2020.html">Grudzien et al. 2020</a> Because the second order Taylor-Stratonovich scheme relies specifically on the structure of the Lorenz-96 model with additive noise, this is included separately in the <a href="../../models/L96/#Lorenz-96-model">Lorenz-96 model</a> sub-module.  These time steppers over-write the value of the model state <code>x</code> in-place for efficient ensemble integration.</p><p>The four-stage Runge-Kutta scheme follows the convention in data assimilation of the extended state formalism for parameter estimation. In particular, the parameter sample should be included as trailing state variables in the columns of the ensemble array.  If the following conditional is true:</p><pre><code class="language- hljs">true == haskey(kwargs, &quot;param_sample&quot;)</code></pre><p>the <code>state_dim</code> parameter specifies the dimension of the dynamical states and creates a view of the vector <code>x</code> including all entries up to this index.  The remaining entries in the state vector <code>x</code> will be passed to the <code>dx_dt</code> function in a dictionary merged with the <code>dx_params</code>  <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.ParamDict-Tuple{Any}"><code>ParamDict</code></a>, according to the <code>param_sample</code> indices and parameter values specified in <code>param_sample</code>. The parameter sample values will remain unchanged by the time stepper when the dynamical state entries in <code>x</code> are over-written in place.</p><p>Setting <code>diffusion &gt; 0.0</code> introduces additive noise to the dynamical system.  The main <a href="#DataAssimilationBenchmarks.DeSolvers.rk4_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.rk4_step!</code></a> has convergence on order 4.0 when diffusion is equal to zero, and both strong and weak convergence on order 1.0 when stochasticity is introduced.  This is the recommended out-of-the-box solver for any generic DA simulation for the statistically robust performance, versus Euler-(Maruyama). When specifically generating the truth-twin for the Lorenz-96 model with additive noise, this should be performed with the <a href="../../models/L96/#DataAssimilationBenchmarks.L96.l96s_tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.L96.l96s_tay2_step!</code></a>, while the ensemble should be generated with the <a href="#DataAssimilationBenchmarks.DeSolvers.rk4_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.rk4_step!</code></a>.  See the benchmarks on the <a href="https://gmd.copernicus.org/articles/13/1903/2020/">L96-s model</a> for a full discussion of statistically robust model configurations.</p><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.em_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real" href="#DataAssimilationBenchmarks.DeSolvers.em_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.em_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">em_step!(x::VecA(T), t::Float64, kwargs::StepKwargs) where T &lt;: Real</code></pre><p>Steps model state with the Euler-Maruyama scheme.</p><p>This method has order 1.0 convergence for ODEs and for SDEs with additive noise, though has inferior performance to the four stage Runge-Kutta scheme when the amplitude of the SDE noise purturbations are small-to-moderately large.</p><p>This overwrites the input in-place and returns the updated</p><pre><code class="nohighlight hljs">return x</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.rk4_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real" href="#DataAssimilationBenchmarks.DeSolvers.rk4_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.rk4_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rk4_step!(x::VecA(T), t::Float64, kwargs::StepKwargs) where T &lt;: Real</code></pre><p>Steps model state with the 4 stage Runge-Kutta scheme.</p><p>The rule has strong convergence order 1.0 for generic SDEs and order 4.0 for ODEs. This method overwrites the input in-place and returns the updated</p><pre><code class="nohighlight hljs">return x</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.DeSolvers.tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real" href="#DataAssimilationBenchmarks.DeSolvers.tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.DeSolvers.tay2_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tay2_step!(x::VecA(T), t::Float64, kwargs::StepKwargs) where T&lt;: Real</code></pre><p>Steps model state with the deterministic second order autonomous Taylor method.</p><p>This method has order 2.0 convergence for autonomous ODEs. Time variable <code>t</code> is just a dummy variable, where this method is not defined for non-autonomous dynamics. This overwrites the input in-place and returns the updated</p><pre><code class="nohighlight hljs">return x</code></pre></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../models/ObsOperators/">« ObsOperators</a><a class="docs-footer-nextpage" href="../EnsembleKalmanSchemes/">EnsembleKalmanSchemes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 12 September 2022 19:10">Monday 12 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

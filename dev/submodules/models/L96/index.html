<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>L96 · DataAssimilationBenchmarks</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">DataAssimilationBenchmarks</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">DataAssimilationBenchmarks</span><ul><li><a class="tocitem" href="../../../home/Introduction/">Introduction</a></li><li><a class="tocitem" href="../../../home/Getting Started/">Getting Started</a></li><li><a class="tocitem" href="../../../home/DataAssimilationBenchmarks/">Global Types</a></li></ul></li><li><span class="tocitem">Submodules</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>L96</a><ul class="internal"><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li></ul></li><li><a class="tocitem" href="../IEEE39bus/">IEEE39bus</a></li><li><a class="tocitem" href="../ObsOperators/">ObsOperators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../methods/DeSolvers/">DeSolvers</a></li><li><a class="tocitem" href="../../methods/EnsembleKalmanSchemes/">EnsembleKalmanSchemes</a></li><li><a class="tocitem" href="../../methods/XdVAR/">XdVAR</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Experiments</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../experiments/Workflow/">Workflow</a></li><li><a class="tocitem" href="../../experiments/GenerateTimeSeries/">GenerateTimeSeries</a></li><li><a class="tocitem" href="../../experiments/FilterExps/">FilterExps</a></li><li><a class="tocitem" href="../../experiments/SmootherExps/">SmootherExps</a></li><li><a class="tocitem" href="../../experiments/SingleExperimentDriver/">SingleExperimentDriver</a></li><li><a class="tocitem" href="../../experiments/ParallelExperimentDriver/">ParallelExperimentDriver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../analysis/ProcessExperimentData/">ProcessExperimentData</a></li><li><a class="tocitem" href="../../analysis/PlotExperimentData/">PlotExperimentData</a></li></ul></li></ul></li><li><span class="tocitem">Community</span><ul><li><a class="tocitem" href="../../../community/Contributing/">Contributing</a></li><li><a class="tocitem" href="../../../community/CodeOfConduct/">Contributor Covenant Code of Conduct</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>L96</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>L96</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/master/docs/src/submodules/models/L96.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lorenz-96-model"><a class="docs-heading-anchor" href="#Lorenz-96-model">Lorenz-96 model</a><a id="Lorenz-96-model-1"></a><a class="docs-heading-anchor-permalink" href="#Lorenz-96-model" title="Permalink"></a></h1><p>The classical form for the (single-layer) Lorenz-96 equations are defined as </p><p class="math-container">\[\begin{align}
\frac{\mathrm{d}\pmb{x}}{\mathrm{d} t} = \pmb{f}(\pmb{x}),
\end{align}\]</p><p>where for each state component <span>$i\in\{1,\cdots,n\}$</span>,</p><p class="math-container">\[\begin{align}
f^i(\pmb{x}) &amp;=-x^{i-2}x^{i-1} + x^{i-1}x^{i+1} - x^i + F
\end{align}\]</p><p>such that the components of the vector <span>$\pmb{x}$</span> are given by the variables <span>$x^i$</span> with periodic boundary conditions, <span>$x^0=x^n$</span>, <span>$x^{-1}=x^{n-1}$</span> and <span>$x^{n+1}=x^{1}$</span>.  The term <span>$F$</span> in the Lorenz-96 system is the forcing parameter that injects energy to the model. With the above definition for the classical Lorenz-96 equations, we define the L96-s model with additive noise (of scalar covariance) as</p><p class="math-container">\[\begin{align}
\frac{\mathrm{d} \pmb{x}}{\mathrm{d} t} = \pmb{f}(\pmb{x}) + s(t)\mathbf{I}_{n}\pmb{W}(t),
\end{align}\]</p><p>where <span>$\pmb{f}$</span> is defined as in the classical equations, <span>$\mathbf{I}_n$</span> is the <span>$n\times n$</span> identity matrix, <span>$\pmb{W}(t)$</span> is an <span>$n$</span>-dimensional Wiener process and <span>$s(t):\mathbb{R}\rightarrow \mathbb{R}$</span> is a measurable function of (possibly) time-varying diffusion coefficients. This model is analyzed in-depth for data assimilation twin experiments in the manuscript <a href="https://gmd.copernicus.org/articles/13/1903/2020/gmd-13-1903-2020.html">Grudzien et al. 2020</a> and further details of using the system for data assimilation benchmarks in stochastic dynamics are discussed there.  The methods in the below define the model equations, the Jacobian, and the order 2.0 Taylor-Stratonovich scheme derived especially for statistically robust numerical simulation of the truth twin of the L96-s system.</p><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.L96.compute_α_ρ-Tuple{Int64}" href="#DataAssimilationBenchmarks.L96.compute_α_ρ-Tuple{Int64}"><code>DataAssimilationBenchmarks.L96.compute_α_ρ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_α_ρ(p::Int64)</code></pre><p>Computes auxiliary functions for the 2nd order Taylor-Stratonovich expansion. The constants <code>α</code> and <code>ρ</code> need to be computed once, only as a function of the order of truncation of the Fourier series, the argument <code>p</code>, for the integration method.  These constants are then supplied as arguments to <code>l96s_tay2_step!</code> in <code>kwargs</code>. See <a href="#DataAssimilationBenchmarks.L96.l96s_tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>l96s_tay2_step!</code></a> for the interpretation and usage of these constants.</p><pre><code class="nohighlight hljs">return α(p)::Float64, ρ(p)::Float64</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/b9edab763fe713e761bcb839dbf812757b717d08/src/models/L96.jl#L102-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.L96.dx_dt-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Union{Dict{String, Array{T1}}, Dict{String, Vector{T1}}} where T1&lt;:T}} where T&lt;:Real" href="#DataAssimilationBenchmarks.L96.dx_dt-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Union{Dict{String, Array{T1}}, Dict{String, Vector{T1}}} where T1&lt;:T}} where T&lt;:Real"><code>DataAssimilationBenchmarks.L96.dx_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dx_dt(x::VecA(T), t::Float64, dx_params::ParamDict(T)) where T &lt;: Real</code></pre><p>Time derivative for Lorenz-96 model, <code>x</code> is a  model state of size <code>state_dim</code> and type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.VecA-Tuple{Any}"><code>VecA</code></a>, <code>t</code> is a dummy time argument for consistency with integration methods, <code>dx_params</code> is of type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.ParamDict-Tuple{Any}"><code>ParamDict</code></a> which is called for the forcing parameter.</p><p>Returns time derivative of the state vector</p><pre><code class="nohighlight hljs">return dx</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/b9edab763fe713e761bcb839dbf812757b717d08/src/models/L96.jl#L24-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.L96.jacobian-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Union{Dict{String, Array{T1}}, Dict{String, Vector{T1}}} where T1&lt;:T}} where T&lt;:Real" href="#DataAssimilationBenchmarks.L96.jacobian-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Union{Dict{String, Array{T1}}, Dict{String, Vector{T1}}} where T1&lt;:T}} where T&lt;:Real"><code>DataAssimilationBenchmarks.L96.jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobian(x::VecA(T), t::Float64, dx_params::ParamDict(T)) where T &lt;: Real</code></pre><p>Computes the Jacobian of Lorenz-96 about the state <code>x</code> of type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.VecA-Tuple{Any}"><code>VecA</code></a>. The time variable <code>t</code> is a dummy variable for consistency with integration methods, <code>dx_params</code> is of type <a href="../../../home/DataAssimilationBenchmarks/#DataAssimilationBenchmarks.ParamDict-Tuple{Any}"><code>ParamDict</code></a> which is called for the forcing parameter. Note that this is designed to load entries in a zeros array and return a sparse array to make a compromise between memory and computational resources.</p><pre><code class="nohighlight hljs">return sparse(dxF)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/b9edab763fe713e761bcb839dbf812757b717d08/src/models/L96.jl#L59-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.L96.l96s_tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real" href="#DataAssimilationBenchmarks.L96.l96s_tay2_step!-Union{Tuple{T}, Tuple{Union{Vector{T1}, SubArray{T1, 1}} where T1&lt;:T, Float64, Dict{String, Any}}} where T&lt;:Real"><code>DataAssimilationBenchmarks.L96.l96s_tay2_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">l96s_tay2_step!(x::VecA(T), t::Float64, kwargs::StepKwargs) where T &lt;: Real</code></pre><p>One step of integration rule for l96 second order taylor rule The constants <code>ρ</code> and <code>α</code> are to be computed with <code>compute_α_ρ</code>, depending only on <code>p</code>, and supplied for all steps. This is the general formulation which includes, e.g., dependence on the truncation of terms in the auxilliary function <code>C</code> with respect to the parameter <code>p</code>.  In general, truncation at <code>p=1</code> is all that is necessary for order 2.0 convergence.</p><p>This method is derived in <a href="https://gmd.copernicus.org/articles/13/1903/2020/gmd-13-1903-2020.html">Grudzien, C. et al. (2020).</a> NOTE: this Julia version still pending validation as in the manuscript</p><pre><code class="nohighlight hljs">return x</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/b9edab763fe713e761bcb839dbf812757b717d08/src/models/L96.jl#L126-L142">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataAssimilationBenchmarks.L96.mod_indx!-Tuple{Int64, Int64}" href="#DataAssimilationBenchmarks.L96.mod_indx!-Tuple{Int64, Int64}"><code>DataAssimilationBenchmarks.L96.mod_indx!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mod_indx!(indx::Int64, dim::Int64)</code></pre><p>Auxiliary function to return state vector indices for the Lorenz-96 model, where <code>indx</code> is taken mod <code>dim</code>.  Mod zero is replaced with <code>dim</code> for indexing in Julia state vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgrudz/DataAssimilationBenchmarks.jl/blob/b9edab763fe713e761bcb839dbf812757b717d08/src/models/L96.jl#L8-L13">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../home/DataAssimilationBenchmarks/">« Global Types</a><a class="docs-footer-nextpage" href="../IEEE39bus/">IEEE39bus »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 17 October 2022 19:57">Monday 17 October 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
